<!DOCTYPE html>
<html>
<head>
	<title>Movie assignment</title>

	<script
  src="https://code.jquery.com/jquery-3.1.1.min.js"
  integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
  crossorigin="anonymous"></script>
</head>
<body>
<!--<button onclick = "findAnswers()">Get Info</button>-->

<p id= "test"></p>

<p>1. What user(s) had the most checkouts in the last 12 months?</p>
<p id= "mostCheckouts"></p>

<p>2. What month(s) had the most checkouts in the last 12 months?</p>
<p id = "busiestMonth"></p>

<p>3. What is/are the title(s) of the movie(s) that was/were the most checked out in the last 12 months?</p>
<p id = "mostPopularMovie"></p>
<script>
  
  
function getFile(filepath, callback){
  	//filepath leads to the txt file (could be url or local)
  	//callback is a function that is called when the txt file has been loaded
  	xmlhttp = new XMLHttpRequest();
	xmlhttp.onreadystatechange = function(){
		if(xmlhttp.readyState ==4 && xmlhttp.status == 200){
          	var data = xmlhttp.responseText;
          	//ideally, you'd check to make sure callback is a function before calling it
            callback(data);
		} //end of if
	};// end of function expression
	xmlhttp.open("GET", filepath ,true);
	xmlhttp.send();
}
  
function processData(rawData){
	console.log(rawData);
  	//turn txt string into usable/searchable array
  	var dataArray = rawData.split("\n");
  	doTasks(dataArray);
}
  
function doTasks(dataArray){
	var mostCheckouts = getMostCheckouts(dataArray),
        busiestMonth = getBusiestMonth(dataArray),
        mostPopularMovie = getMostPopularMovie(dataArray);
  	document.getElementById("mostCheckouts").innerHTML = mostCheckouts;
  	document.getElementById("busiestMonth").innerHTML = busiestMonth;
  	document.getElementById("mostPopularMovie").innerHTML = mostPopularMovie;
}
  
getFile("http://159.203.175.239:9001/checkouts.txt", processData);
  
 //my processData is calling three functions better to do this in three helper functions. 
  
//helper functions, utility functions
//dataArray corresponds to my dataUserArr 

function getMostCheckouts(dataArray){
  	var mostCheckouts = null; //???
  
  	return mostCheckouts;
}
  
function getBusiestMonth(dataArray){
	var busiestMonth = null; //???
  
  	return busiestMonth;//make sure there are return values for all of these functions. 
}
  
function getMostPopularMovie(dataArray){
	var mostPopularMovie = null; //???
  //do another ajax call 
  //take movieModeId and connect with element in the array. 
  //for loop and if:  work through array until get something that matches.
  //return and array.join(", ") so that I can have more than one value. 
  	return mostPopularMovie;
}
  
  
</script>
</body>
</html>